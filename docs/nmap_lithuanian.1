.\" Á Lietuviø kalbà iðvertë
.\" Aurimas Mikalauskas <inner@crazy.lt>
.\" 2001 03 17
.de Sp
.if n .sp
.if t .sp 0.4
..
.TH NMAP 1
.SH PAVADINIMAS
nmap \- tinklo tyrinëjimo árankis bei saugumo skeneris
.SH SINTAKSË
.B nmap
[skanavimo tipas(ai)] [opcijos] <hostas/tinklas #1 ... #n>
.SH APIBÛDINIMAS

.I nmap'as
yra sukurtas tam, kad leistø sistemø
administratoriams bei smalsiems individams skanuoti
didelius tinklus, siekiant nustatyti kokie hostai
yra veikiantys ir kokias paslaugas jie siûlo.
.I nmap'as
turi be galo daug skanavimo technologijø,
tai: UDP, TCP connect(), TCP SYN (pusiau atviras),
ftp proxy (bounce ataka), Reverse-ident,
ICMP(ping sweep), FIN, ACK sweep, Xmas Tree, SYN sweep,
bei Null skan'as.
.I Skanavimo Tipai
sekcijoje rasite apie tai smulkesnës informacijos.
nmap'as taip pat turi nemaþai paþangiø savybiø, tokiø
kaip nutolusio kompiuterio (toliau vadinamo 'remote')
(O)peracinës (S)istemos nustatymas per TCP/IP
fingerprintinima, stealth (vogtinis)  skanavimas,
dinaminës pauzës ir retransimisijos skaièiavimai,
lygiagretusis skanavimas , nepasiekiamø host'ø nustatymas
skanuojant lygiagreèiu skanavimo metodu, decoy skanavimas,
filtruojamø portø nustatymas, tiesioginis RPC skanavimas,
fragmentinis skanavimas, bei labai lankstus taikinio
ir portø nurodymas.
.PP
nmap'o autorius stengiasi kaip galima daugiau ávairiø
nmap'o galimybiø suteikti ne tik root vartotojui, bet ir
paprastam sistemos vartotojui, deja daugëlis kritiniø
sistemos branduolio (kernel) interfeisø (tokiø kaip
"raw socket'ai") reikalauja root'o privilegijø, todël
nmap'as turëtø bûti naudojamas root'u kai tik ámanoma.
.PP
nmap'o naudojimo rezultatas daþniausiai bûna
paprasèiausias sàraðas ádomiø portø, rastø skanuojamoje
maðinoje(se). Nmap'as visada parodo kokià paslaugà (service)
teikia portas, jo numerá, bûsenà bei protokolà. Bûsanà
nusako vienas ið trijø þodþiø: "open", "filtered", "unfiltered".
"open" (atviras) reiðkia, kad taikinys leis prisijungti prie
ðito porto. "filtered" (filtruojamas) reiðkia, kad firewall'as
(ugnies siena), filtras ar dar kaþkoks ádomus árankis dengia
portà, dël to nmap'as tiklsiai negali nustatyti ar portas
atviras. "unfiltered" (nefiltruojamas) parodo, kad portas
yra tikrai "closed" (uþdarytas) ir nera dengiamas jokio
firewall'o/filtro. Nefiltruojamas portas yra gan áprastas
atvëjis ir yra rodomas tik tuo atveju, kai dauguma ið skanuotø
portø yra filtruojami.
.PP
Priklausomai nuo to, kokios opcijos naudojamos, nmap'as
taip pat gali parodyti ir nutolusio kompiuterio: (O)peracinæ
(S)istemà, TCP susekamumà, vartotoju vardus, kuriems priklauso
tam tikri procesai, DNS vardus ir dar vienà kità.
.SH OPCIJOS
Prasmingos opcijos visos gali bûti raðomos kartu (t.y. vienoje
eilutëje).
.I nmap'as
stengsis pasakyti, kokias klaidas esate padaræ
(aiðku jei esate :).
.Sp
Jei esate nekantrus, galite iðkarto ðoktelti á sekcijà
.I pavyzdþiai
gale dokumento, kur gan aiðkiai parodo naudojimà. Taip pat
galite paleisti
.B nmap -h
ir pamatysite pagrindines opcijas, su trumpais apraðymais.
.TP
.B SKANAVIMØ TIPAI
.TP
.B \-sT
paprasèiausias TCP connect() skanavimas. Jûs bandote prisijungti
prie kiekvieno porto ið eilës. Jei portas klausosi, nmap'as
prisijungia prie jo, taigi jei host'as logina, jis matys, kad
bandote jungtis. Ðis metodas yra tiksliausias, bet rekomenduoèiau
já naudoti tik tuo atveju, jei skanuojate savo ar draugo
kompiuterá, t.y. toká, dël kurio vëliau tikrai nesusilauksite
nemalonumø.
.TP
.B \-sS
TCP SYN skanavimas, kitaip dar daþnai vadinamas kaip
"pusiau-atviras" skanavimas, nes nëra padaromas TCP prisijungimas.
Jûs paprasèiausiai nusiunèiate TCP SYN paketukà kaip kad norëdamas
prisijungti ir laukiate atsakymo. Pakankamai neblogas metodas,
bet jei yra filtruojamø portø (pvz. pastatytas firewall'as) ir
host kompiuteris juos logina, - bûsite pastebëtas.
.TP
.B \-sF \-sX \-sN
Stealth FIN, Xmas Tree bei Null skanavimo reþimai. Tai yra ðiek
tiek saugesni skanavimo bûdai nei TCP SYN (pastebimumo
atþvilgiu), bet deja nei vienas ið jø neveikia M$ sistemoms.
Ið kitos pusës, tai nebloga priemonë, kurios pagalba galima
nustatyti ar tai M$ sistema ar ne, t.y. jei -sF -sX arba -sN
parodo, kad visi portai uþdaryti, o -sS rodo kelis atvirus
portus, taikinys greièiausiai windows dëþutë.
.TP
.B \-sP
Tai paprasèiausias ping'as, kuris parodo kurie hostai tinkle
yra gyvi. Atliekama paprasèiausiai siunèiant ICMP echo praðymà
(request). Deja kai kurie saitai (kaip mail.takas.lt) blokuoja
praðymus. Kad ið tikro ásitikinti, ar hostas negyvas, nmap'as
nusiunèia ir TCP ack paketukà á 80 (standartiðkai) portà. Jei
gauname atgal RST, reiðkia hostas gyvas. Pagal standartà
(r00t'ui) nmap'as naudoja abu ICMP bei ACK metodus. Pakankamai
efektyvu, nes vienu metu galite patikrinti #n hostø.
.TP
.B \-sU
UDP skanavimas. Naudojamas tam, kad nustatyti kokie UDP (User
Datagram Protocol,  RFC 768) portai yra atviri.
.Sp
Kai kurie mano, kad UDP skanavimas yra beprasmiðkas, bet já
prisiminti verta vien dël vienos Solaris rcpbind skylës. Taip
pat yra cDc Back Orifice trojanas, kuris atsidaro UDP portà ant
window'sø. Gaila tik, kad UDP skanavimas kartais gali trukti
labai ilgai.
.TP
.B \-SO
IP protokolo skanavimas. Ðis metodas yra naudojamas tam, kad
nustatyti kokius protokolus naudoja jûsø taikinys. Technika
labai paprasta: siunèiami IP paketai be jokio protokolo header'io
á visus nurodytus protokolus. Jeigu pvz gauname "ICMP protocol
unreachible" (ICMP protoklolas nepasiekiamas) atsakymà, vadinasi
protokolas nenaudojamas, prieðingu atveju skaitoma, kad jis
atviras.
.TP
.B \-sA
ACK skanavimas: ðitas metodas paprastai yra naudojamas tam,
kad iðsiaiðkinti firewall'ø (ugnies sinø) taisykles. Jis gali
padëti nustatyti ar firewall'as tikras, ar paprasèiausias
paketø filtras, blokuojantis áplaukianèius SYN paketukus.
.TP
.B \-sW
Window skanavimas. Ðis skanavimo bûdas labai panaðus á ACK
skanà, skirtumas tik tas, kad ðis skanavimo metodas kartais
parodo ir atvirus portus (ACK jø nerodo).
.TP
.B \-sR
RPC skanavimas. Praskanavus parodoma kokia programa ir jos versija
laiko RPC portus atvirus.
.TP
.B \-b <ftp relay hostas>
Dar vienas pakankamai originalus skanavimo bûdas, t.y.
pasinaudojant ftp proxy serveriu. <ftp relay host'o> formatas
gali bûti useris:passwordas@serveris:portas . Viskas iðskyrus
serverá yra nebûtina.
.TP
.B BENDROSIOS OPCIJOS
Nei viena ið ðiø nëra bûtina, bet kai kurios gali bûti pakankamai
naudingos
.TP
.B \-P0
Skanuoti ið kart, nepabandþius ið pradþiø ping'int serverio.
Tai naudinga skanuojant tokius kaip mail.takas.lt, kurie
neatsakinëja á ICMP echo request'us. Tokiu atveju reikëtø
naudoti
.B \-P0
arba
.B \-PT80.
.TP
.B \-PT
Naudoti TCP "ping'à" vietoje standartinio ICMP ping'o. Naudinga
tokiais atvejais, kai serveris neatsakinëja i ICMO echo
request'us. Taip pat galima naudoti kartu su postu (-PT<portas>).
.TP
.B \-PS
Naudoja SYN (prisijungimo praðymà) vietoje ACP
.TP
.B \-PI
Paprastas ping'as + suranda subnet'o broadcast'u adresus tinkle.
.TP
.B \-PB
Standartinis ping'inimo metodas: naudoja ACP bei ICMP ping'us
kartu. Geriausia bûdas patikrinti firewall'us, kurie blokuoja
vienà ið jø.
.TP
.B \-O
Viena geriausiø nmap'o ypatybiø - serverio OS'o atpaþinimas
pagal jo fingerprint'us (jei atvirai, pats nelabai þinau kas
per biesas tie fingerprintai).
.TP
.B \-I
Ájungiamas TCP reverse ident skanavimas. Kaip 1996  Dave'as
Goldsmith'as pastebëjo, ident protokolas (rfc 1413) leidþia
pamatyti, kokiam useriui priklauso procesas, kuris naudoja
TCP susijungima. Taigi, tu gali pvz prisijungti prie 80 porto
ir tada pasinaudojes inentd'u, gali pamatyti ar http serveris
yra paleistas root'u ar kokiu kitu userium.
.TP
.B \-f
Skanuojant SYN (-sS) , FIN (-sF), XMAS (-sX) arba NULL (-sN)
metodu, naudojami labai maþyèiai sufragmentuoti IP paketai.
.TP
.B \-v
Verbose mode. Labai rekomenduojama opcija, ypaè jei norit geriau
suprasti kas èia dedasi. naudodamas ðià opcijà du kartus, efektas
bus dar geresnis. Gali naudoti ir dvigubà -d, efektas - nerealus.
Nepabandæs, nesuprasi.
.TP
.B \-h
Jei norite kad nedidelis langelis jums trumpai primintu kelias
pagrindines komandas, ði opcija - jums.
.TP
.B \-oN <logas>
Viskas, kas vyksta ekrane bus loginama á "logas" failà.
.TP
.B \-oX <logas>
Skanavimo rezultatai iðsaugomi XML formatu á failà, kurá nurodote
kaip argumentà ðiai opcijai.
.TP
.B \-oG <logas>
Ði opcija iðsaugo skanavimo rezultatus taip, kad jûs juos galetumëte
lengvai grepinti. Ðis gan primityvus formatas iðsaugo viskà vienoje
eilutëje.
.TP
.B \-oS <logas>
Loginama á failà "logas" "skipt kiddie" formatu.
.TP
.B \--resume <logas>
Skanavimas, kuris buvo nutrauktas su ^C, gali bûti pratæstas,
su sàlyga, kad viskas buvo loginama su -oN opcija.
Daugiau jokie parametrai negali bûti pateikti (jie bus tokie,
kokie buvo naudojami loginant). nmap'as pradës skanuoti nuo
sekanèios maðinos, po tos, kuri paskutinë buvo sëkmingai
nuskanuota..
.TP
.B \-iL <failas>
Nuskaito hostus (IP adresus) ið failo "failas". Hostai faile turi
bûti atskirti tarpais, TAB'ais arba atskirose linijose. deja
opcijø nurodyti jokiø negalite tame faile, uþtat yra galimybë jas
nurodyti komandinëje eilutëje.
.TP
.B \-iR
Ðita opcija priverèia nmap'à generuoti atsitiktinius hostus. Jei
kada neturësite kà veikti, pabandykite `nmap -sS -iR -p 80', kad
surastumëte keletà www serveriø.
.TP
.B \-p <portai>
Galite nurodyti kurá/kuriuos portus tikrinti. pvz. -p 110
patikrins ar hostas turi pop3 serverá, taip pat galite miðriai
nurodinëti portus:

    -p 21,60-90,1243     --  21, visi nuo 60 iki 90 bei 1243 portas
    -p 1-                --  visi portai nuo 1 iki 65535.
.TP
.B \-F
Greitasis metodas. Skanuoja tik tuos portus, kurie nurodyti nmap'o
services faile (pagal default'à - /usr/local/lib/nmap/nmap-services)
.TP
.B \-D <decoy1 [,decoy2][,decoyN][,ME]>
Decoy skanavimas priverèia skanuojamà host'à manyti, kad já vienu
metu skanuoja visi nurodyti decoy'iai. Hostø logai gali parodyti
5-10 skanavimø ið unikaliø IP adresø, bet kuris ið jø skanuoja
ið tikro jie pasakyti negalës.
.Sp
Atskirk kiekvienà decoy'á kableliais (be tarpo) ir gali tarp jø
áterpti 'ME' kaip vienà ið decoy'iø. nmap'as ten áterps tavo
adresà. Jei ðito nenurodysi, nmap'as atsitiktinai iðrinks tau
vietà. Tiesa, jei 'ME' áraðysi 6-oje ar dar vëlesnëje vietoje,
kai kurie skanavimø detektoriai (tokie kaip Solar Designer'io
nepakartojamas scanlog daemon'as) gali tavo IP iðviso neparodyti.
.Sp
Nepamirðk, kad hostai, kuruos naudosi kaip decoy'ius, turi bûti
gyvi, kitaip gali uþ-SYN-flood'inti taikiná, o be to labai
nesunku bus surasti skanuotojà, jei jis bus vienintelis gyvas
visame tinkle.
.Sp
Atkreipk dëmesá ir á tai, kad kai kurie (durnesni) portø
skanavimø detektoriai gali aplamai skanuojantiems host'ams
uþdrausti priëjimà. Ásivaizduok, kas gali nutikti, jei vienà
ið decoy'iø nurodytum "localhost'à" :)
.Sp
Decoy skanavimas gali bûti naudojamas kartu su ping (naudojant
ICMP, SYN, ACK, ar dar kà nors) arba tikru portø skanavimu bei
bandant surasti remote OS'à ( -O ).
.TP
.B \-S <IP_adresas>
Kartais nmap'as gali nerasti jûsø adreso. Tokiu atveju galite
naudoti -S opcijà su jûsø IP adresu bei interfeisu, kuriuo
siûsite paketus.
.TP
.B \-e <interfeisas>
Nurodo nmap'ui kokiu interfeisu siøsti paketus.
(lo, ppp0, eth0 ir etc.)
.TP
.B \-g <portas>
Nurodo ið kokio porto skanuoti. Daugelis firewall'ø bei filtrø
padaro iðimtis DNS (53) bei FTP-DATA (20) paketams.
.TP
.B \-n
Liepia nmap'ui net nemëginti rezolvinti ip adresø i jø vardus,
nes daþnai tai bûna labai lëtas procesas ir stabdo nmap'o darbà.
.TP
.B \-R
Prieðingai nei -n opcija, -R liepia nmap'ui visada pamëginti
iðrezolvinti ip adresà.
.TP
.B \-r
Nurodo nmap'ui portus skanuoti
.B NE
atsitiktine tvarka.
.TP
.B --randomize_hosts
Nmap'as atsitiktine tvarka iðmaiðo kiekvienà grupæ ið daugiau nei
2048 hostø prieð pradedant juos skanuoti. Tai ðiek tiek suklaidina
ávairius tinklo stebejimo árankius.
.TP
.B \-M <maximalus susijungimu skaicius>
Nustato naksimalø susijungimu skaièiø, kuris bus naudojamas
paralelëje su TCP(standartiðkai) skanavimu.
.TP
.B LAIKO APRIBOJIMAI
.TP
.B -T <Paranoid|Sneaky|Polite|Normal|Aggressive|Insane>
Paranoid - pats lëèiausias skanavimo bûdas, Insane - pats
greièiausias, deja ne toks tikslus, ypaè jei tinklas lëtas.
Vietoj þodþiø galite naudoti ir -T (0-5), kur 0 == Paranoid,
1 == Sneaky ir t.t.
.TP
.B --host_timeout <milisekundës>
Nurodo kiek laiko nmap'as gali skanuoti duotàjá IP. Laikas turi
bûti nemaþiau nei 200 milisekundþiø.
.TP
.B --max_rtt_timeout <milisekundës>
Kiek daugiausia laiko nmap'as gali laukti atsakymo ið skanuojamo
IP.
.TP
.B --scan_delay <milisekundës>
Nustato minimalø laiko tarpà, kuri nmap'as turi laukti tarp
bandymø. Tai naudingiausia siekiant sumaþinti tinklo apkrovimà.

.SH TAIKINIO NURODYMO BÛDAI
Viskas, kas nëra opcijos, nmap'e suprantama kaip taikinys.
Paprasèiausias bûdas yra nurodyti konkreèius IP arba hostus.
Jeigu norite nuskanuoti IP adresø subnet'à, galite pridëti
.B /maskæ
hostname'ui ar IP adresui.
.B Maskë
turi bûti tarp 0
(norint nuskanuoti visà internetà) ir 32 (norint nuskanuoti
konkretø host'à/IP. Naudok /24 'C' klasës adresø skanavimui
bei /16 'B' klasës adresø skanavimui.
.Sp
nmap'as taip pat turi gan patogià galimybæ nustatinëti IP
adresus sàraðais/atstumais. pvz. gali nuskanuoti 'B' klasæ
uþraðydamas 128.210.*.* arba 128.210.0-255.0-255 arba dar
128.210.0-50,51-255.1,2,3,4,5-255 . Manau kad tai pakankamai
patogu ir nesudëtinga.
.SH KELETAS PAVYZDÞIØ
.Sp
.B nmap -sX -e lo -P0 -S 127.0.0.3 localhost
.Sp
Pasinaudodamas Xmas Tree skanavimo metodu, apsimetinëdamas,
kad esu 127.0.0.3 Loopback protokolu skanuoju savo localhost'à
Ðtai kaip atrodo ipchains'ø log'as:
.Sp
Packet log: input DENY lo PROTO=6 127.0.0.3:37009 127.0.0.1:139
L=40 S=0x00 I=53682 F=0x0000 T=41 (#1)
.Sp
kaip matote, kernelis yra ásitikinæs, kad já skanuoja ið 127.0.0.3
o tai ir yra vienas svarbiausiø uþdaviniø - likti nematomiems :)
.Sp
.B nmap -sS -O target.example.com/24
.Sp
stealth SYN metodu nuskanuoja visas 255 maðinas, esanèias
target.example.com 'C' klasëje. Taip pat bando nustatyti
kiekvieno ið jø operacinæ sistemà.
.Sp
.B host -l company.com | cut '-d ' -f 4 | ./nmap -v -iL -
.Sp
suranda visus *.company.com hostus ir atiduoda juos nmap'ui,
kuris savo ruoþtu ásijungæs verbose mode visus juos nuskanuoja.
.Sp
.B nmap -sN -D microsoft.com,mail.takas.lt,ME -oN /root/crazy -p 1-1024 -O crazy.com
.Sp
skanauoja Null skanavimo reþimu, panaudoja du decoy adresus,
viskà logina á /root/crazy failà, skanuoja nuo 1 iki 1024 crazy.com
portus bei stengiasi atspëti crazy.com serverio operacinæ sistemà
.SH BUGAI
Vabalëliai? Kokie dar vabalëliai? Na.. jei rasit kokiø, bûtinai
siûskit autoriui: <fyodor@insecure.org> . Pachai taip pat labai
laukiami. Taip pat nepamirðkite siûsti OS'ø fingerprintus, kad
nmap'o autoriai galëtø plësti duom. bazæ. Apie tai smulkiau
galite rasti docs/nmap-fingerprinting-article.txt dokumente
arba nmap'o puslapyje: http://www.insecure.org/nmap
.SH AUTORIUS
.Sp
Fyodor
.I <fyodor@insecure.org>
.SH IÐVERTË
.Sp
Aurimas Mikalauskas
.I <inner@crazy.lt>
.Sp
.SH PLATINIMAS
.Sp
Naujausià
.I nmap'o
versijà visada galite rasti èia:
.Sp
.I http://www.insecure.org/nmap/
.Sp
.I nmap
is (C) 1997,1998,1999,2000 by Fyodor (fyodor@insecure.org)
.Sp
.I libpcap'as
yra taip pat platinamas kartu su nmap'u. Autorines
teises á já turi Van Jacobson, Craig Leres ir Steven McCanne,
visi ið Lawrence Berkeley nacionalinës Laboratorijos Kalifornijos
Universiteto,  Berkeley,  CA. Versija platinama su nmap'u gali
bûti perraðinëjama. Sourcus galit parsisiûsti ið
.I ftp://ftp.ee.lbl.gov/libpcap.tar.Z
.Sp
.SH PABAIGAI
Dþiaugiuosi, kad pagaliau pasiekëte galà. Dabar jau galite skaityti
save kvalifikuotu nmap'o guru.
.Sp
beje, jei norite kà nors pridëti ar pakeisti ðiame dokumente,
arba (neduok Dieve) radot kokiø tai bug'u, raðykit man adresu,
pateiktu sekcijoje
.B iðvertë.
Ðiaip ðitas manualas abejoju ar bus atnaujinamas,
bet paèià naujausià nmap-lt-HOWTO visada galite
rasti mano puslapyje:
.Sp
.I http://crazy.lt/~inner
