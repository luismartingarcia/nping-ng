From d7f1dc6156f619b81de682a0c89cf47884a798de Mon Sep 17 00:00:00 2001
From: David Fifield <david@bamsoftware.com>
Date: Mon, 9 Apr 2012 17:06:04 -0700
Subject: [PATCH 2/4] Move the inclusion of config.h to the top of scanner.l.

This works around _LARGE_FILES difficulties on AIX.
---
 scanner.l |   11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)

diff --git scanner.l scanner.l
index 064e9c8..93d7b97 100644
--- scanner.l
+++ scanner.l
@@ -1,3 +1,10 @@
+%top{
+/* Must come first for _LARGE_FILE_API on AIX. */
+#ifdef HAVE_CONFIG_H
+#include "config.h"
+#endif
+}
+
 %{
 /*
  * Copyright (c) 1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997
@@ -25,10 +32,6 @@ static const char rcsid[] _U_ =
     "@(#) $Header: /tcpdump/master/libpcap/scanner.l,v 1.112 2008-02-06 10:21:30 guy Exp $ (LBL)";
 #endif
 
-#ifdef HAVE_CONFIG_H
-#include "config.h"
-#endif
-
 #ifdef WIN32
 #include <pcap-stdinc.h>
 #else /* WIN32 */
-- 
1.7.9.5

